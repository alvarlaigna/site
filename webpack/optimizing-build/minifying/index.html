<html lang="en"><head><title>Minifying Build</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui"/><meta name="description" content="
So far, we haven&#x27;t given thought to our build output and no doubt it&#x27;s going to be a little chunky, especially as we included React in it. We can apply a variety of techniques to bring down the size of the vendor bundle. We can also leverage client level caching and load certain assets lazily as weâ€¦"/><meta name="keywords" content="webpack,react,javascript,programming,web development"/><link rel="icon" type="image/png" href="/assets/img/favicon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"/><link rel="stylesheet" href="/assets/main.css"/></head><body><main role="main"><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/assets/img/chapters/skinny.jpg);"></div><h1 class="post__heading">Minifying Build</h1><div class="header-extra"><a href="https://pixabay.com/en/austin-tx-sign-texas-downtown-713746/">BreaLeaDesigns (Public Domain)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/introduction">Introduction</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/webpack-compared">Webpack Compared</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/why-webpack">Why Webpack?</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/developing-with-webpack">Developing with Webpack</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing-with-webpack/getting-started">Getting Started</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing-with-webpack/automatic-browser-refresh">Automatic Browser Refresh</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing-with-webpack/configuring-hmr">Configuring Hot Module Replacement</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing-with-webpack/linting">Linting JavaScript</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing-with-webpack/composing-configuration">Composing Configuration</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/handling-styles">Handling Styles with Webpack</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/handling-styles/loading">Loading Styles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/handling-styles/separating-css">Separating CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/handling-styles/eliminating-unused-css">Eliminating Unused CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/handling-styles/linting">Linting CSS</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/understanding-loaders">Understanding Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/understanding-loaders/loader-definitions">Loader Definitions</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/understanding-loaders/loading-images">Loading Images</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/understanding-loaders/loading-fonts">Loading Fonts</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/building-with-webpack">Building with Webpack</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building-with-webpack/source-maps">Source Maps</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building-with-webpack/splitting-bundles">Splitting Bundles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building-with-webpack/code-splitting">Code Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building-with-webpack/processing-with-babel">Processing with Babel</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building-with-webpack/cleaning-build">Cleaning the Build</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/optimizing-build">Optimizing the Build</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Minifying Build</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing-build/setting-environment-variables">Setting Environment Variables</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing-build/adding-hashes-to-filenames">Adding Hashes to Filenames</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing-build/separating-manifest">Separating a Manifest</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing-build/analyzing-build-statistics">Analyzing Build Statistics</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/advanced-techniques">Advanced Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/advanced-techniques/consuming-packages">Consuming Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/advanced-techniques/authoring-packages">Authoring Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/advanced-techniques/configuring-react">Configuring React</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/extending-webpack">Extending Webpack</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending-webpack/loaders">Extending Webpack with Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending-webpack/plugins">Extending Webpack with Plugins</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/appendices">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/searching-with-react">Searching with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/writing-eslint-plugins">Writing ESLint Plugins</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/customizing-eslint">Customizing ESLint</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/deploying">Deploying Applications</a></li></ul><div><div class="buy-container"><a href="/webpack/introduction"><img class="sidebar-cover" src="/assets/img/webpack_title_page_small.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img class="sidebar-cover" src="/assets/img/react_title_page_small.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div></div></div><div class="chapter"><div class="post__content"><blockquote class="latestpost tip"><div>From the blog:</div><a class="latestpost-link" href="/blog/survivejs-webpack-170">SurviveJS - Webpack - v1.7.0</a></blockquote><div class="chapter-content"><p>So far, we haven&#39;t given thought to our build output and no doubt it&#39;s going to be a little chunky, especially as we included React in it. We can apply a variety of techniques to bring down the size of the vendor bundle. We can also leverage client level caching and load certain assets lazily as we saw earlier.</p>
<p><strong>Minification</strong> is a process where code is simplified without losing any meaning that matters to the interpreter. As a result, your code will most likely look quite jumbled and it will be hard to read. But that&#39;s the point.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Even if we minify our build, we can still generate source maps through the <code>devtool</code> option we discussed earlier. This will give us better means to debug, even production code if we want.</blockquote><h2 class="header"><a class="header-anchor" href="#generating-a-baseline-build" id="generating-a-baseline-build"></a><span class="text">Generating a Baseline Build</span><a class="header-anchor-select" href="#generating-a-baseline-build">#</a></h2>
<p>To get started, we should generate a baseline build so we have something to optimize. Execute <code>npm run build</code>. You should end up with something like this:</p>
<pre><code class="lang-bash">Hash: 9f9739ce8a8c059354ae
Version: webpack 2.2.1
Time: 2705ms
                                 Asset       Size  Chunks                    Chunk Names
                                app.js    2.64 kB       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
  674f50d287a8c48dc19ba404d20fe713.eot     166 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
  b06871f281fee6b241d60582ae9369b9.ttf     166 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
af7ae505a9eed503f8b8e6982036873e.woff2    77.2 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
 fee66e712a8a08eef5805a46892932ad.woff      98 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
  9a0d8fb85dedfde24f1ab4cdb568ef2a.png    17.6 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
                                  0.js  313 bytes       0  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
  912ec66d7572ff821749319396470bde.svg     444 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>  <span class="token punctuation" >[</span>big<span class="token punctuation" >]</span>
                             vendor.js     141 kB       2  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         vendor
                               app.css     3.5 kB       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
                              0.js.map  233 bytes       0  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
                            app.js.map    2.72 kB       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
                           app.css.map   84 bytes       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
                         vendor.js.map     167 kB       2  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         vendor
                            index.html  274 bytes          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
   <span class="token punctuation" >[</span>3<span class="token punctuation" >]</span> ./~/react/lib/ReactElement.js 11.2 kB <span class="token punctuation" >{</span>2<span class="token punctuation" >}</span> <span class="token punctuation" >[</span>built<span class="token punctuation" >]</span>
   <span class="token punctuation" >[</span>7<span class="token punctuation" >]</span> ./~/react/react.js 56 bytes <span class="token punctuation" >{</span>2<span class="token punctuation" >}</span> <span class="token punctuation" >[</span>built<span class="token punctuation" >]</span>
  <span class="token punctuation" >[</span>19<span class="token punctuation" >]</span> ./app/component.js 372 bytes <span class="token punctuation" >{</span>1<span class="token punctuation" >}</span> <span class="token punctuation" >[</span>built<span class="token punctuation" >]</span>
<span class="token punctuation" >..</span>.
</code></pre>
<p>141 kB for a vendor bundle is a lot! Minification should bring down the size quite a bit.</p>
<h2 class="header"><a class="header-anchor" href="#enabling-a-performance-budget" id="enabling-a-performance-budget"></a><span class="text">Enabling a Performance Budget</span><a class="header-anchor-select" href="#enabling-a-performance-budget">#</a></h2>
<p>Webpack provides a feature known as a <strong>performance budget</strong>. The idea is that it will give your build size constraint which it has to follow. The feature is disabled by default, but if enabled it will default to 250 kB limit per entries and assets. Note that the calculation includes extracted chunks to entry calculation.</p>
<p>Performance budget can be configured to provide warnings or errors. If a budget isn&#39;t met and it has been configured to emit an error, it would terminate the entire build.</p>
<p>To integrate the feature to the project, adjust the configuration like this:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span>env<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >if</span> <span class="token punctuation" >(</span>env <span class="token operator" >===</span> <span class="token string" >'production'</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token function" >merge</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span>
      common<span class="token punctuation" >,</span>
<div class="leanpub-insert">
      <span class="token punctuation" >{</span>
        performance<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
          hints<span class="token punctuation" >:</span> <span class="token string" >'warning'</span><span class="token punctuation" >,</span> <span class="token comment" spellcheck="true">// 'error' or false are valid too</span>
          maxEntrypointSize<span class="token punctuation" >:</span> <span class="token number" >100000</span><span class="token punctuation" >,</span> <span class="token comment" spellcheck="true">// in bytes</span>
          maxAssetSize<span class="token punctuation" >:</span> <span class="token number" >50000</span><span class="token punctuation" >,</span> <span class="token comment" spellcheck="true">// in bytes</span>
        <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</div>
      parts<span class="token punctuation" >.</span><span class="token function" >clean</span><span class="token punctuation" >(</span>PATHS<span class="token punctuation" >.</span>build<span class="token punctuation" >)</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>

  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>If you build now (<code>npm run build</code>), you should see a warning like this within the output:</p>
<pre><code class="lang-bash"><span class="token punctuation" >..</span>.

WARNING <span class="token keyword" >in</span> asset size limit: The following asset<span class="token punctuation" >(</span>s<span class="token punctuation" >)</span> exceed the recommended size limit <span class="token punctuation" >(</span>50 kB<span class="token punctuation" >)</span>.
This can impact web performance.
Assets:
  674f50d287a8c48dc19ba404d20fe713.eot <span class="token punctuation" >(</span>166 kB<span class="token punctuation" >)</span>
  912ec66d7572ff821749319396470bde.svg <span class="token punctuation" >(</span>444 kB<span class="token punctuation" >)</span>
  b06871f281fee6b241d60582ae9369b9.ttf <span class="token punctuation" >(</span>166 kB<span class="token punctuation" >)</span>
  af7ae505a9eed503f8b8e6982036873e.woff2 <span class="token punctuation" >(</span>77.2 kB<span class="token punctuation" >)</span>
  fee66e712a8a08eef5805a46892932ad.woff <span class="token punctuation" >(</span>98 kB<span class="token punctuation" >)</span>
  vendor.js <span class="token punctuation" >(</span>141 kB<span class="token punctuation" >)</span>

WARNING <span class="token keyword" >in</span> entrypoint size limit: The following entrypoint<span class="token punctuation" >(</span>s<span class="token punctuation" >)</span> combined asset size exceeds the recommended limit <span class="token punctuation" >(</span>100 kB<span class="token punctuation" >)</span>. This can impact web performance.
Entrypoints:
  app <span class="token punctuation" >(</span>148 kB<span class="token punctuation" >)</span>
      vendor.js
,      app.js
,      app.css
,
  vendor <span class="token punctuation" >(</span>141 kB<span class="token punctuation" >)</span>
      vendor.js

<span class="token punctuation" >..</span>.
</code></pre>
<p>If we do our work right, we will meet the given budget and eliminate this warning as we develop the configuration.</p>
<h2 class="header"><a class="header-anchor" href="#minifying-code" id="minifying-code"></a><span class="text">Minifying Code</span><a class="header-anchor-select" href="#minifying-code">#</a></h2>
<p>Ideally, minification will convert our code into a smaller format without losing any meaning. Usually this means some amount of rewriting code through predefined transformations. Good examples of this include renaming variables or even removing entire blocks of code based on the fact that they are unreachable like an <code>if (false)</code> statement.</p>
<p>Sometimes minification can break code as it can rewrite pieces of code you inadvertently depend upon. Angular 1 was an example of this as it relied on a specific function parameter naming and rewriting the parameters could break code unless you took precautions against it.</p>
<p>The easiest way to enable minification in webpack is to call <code>webpack -p</code>. <code>-p</code> is a shortcut for <code>--optimize-minimize</code>, you can think it as <code>-p</code> for &quot;production&quot;. Alternately, we can use a plugin directly as this provides us more control.</p>
<h3 class="header"><a class="header-anchor" href="#setting-up-minification" id="setting-up-minification"></a><span class="text">Setting Up Minification</span><a class="header-anchor-select" href="#setting-up-minification">#</a></h3>
<p>As earlier, we can define a little function for this purpose and then point to it from our main configuration. By default, UglifyJS will output a lot of warnings and they don&#39;t provide value in this case, so we&#39;ll be disabling them in our setup. Here&#39;s the basic idea:</p>
<p><strong>webpack.parts.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<div class="leanpub-insert">
exports<span class="token punctuation" >.</span>minifyJavaScript <span class="token operator" >=</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span> useSourceMap <span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token punctuation" >{</span>
    plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
      <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>optimize<span class="token punctuation" >.</span>UglifyJsPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
        sourceMap<span class="token punctuation" >:</span> useSourceMap<span class="token punctuation" >,</span>
        compress<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
          warnings<span class="token punctuation" >:</span> <span class="token boolean" >false</span><span class="token punctuation" >,</span>
        <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</div>
</code></pre>
<p>Now we can hook it up with our configuration:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span>env<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >if</span> <span class="token punctuation" >(</span>env <span class="token operator" >===</span> <span class="token string" >'production'</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token function" >merge</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span>
      common<span class="token punctuation" >,</span>
      parts<span class="token punctuation" >.</span><span class="token function" >clean</span><span class="token punctuation" >(</span>PATHS<span class="token punctuation" >.</span>build<span class="token punctuation" >)</span><span class="token punctuation" >,</span>
<div class="leanpub-insert">
      parts<span class="token punctuation" >.</span><span class="token function" >minifyJavaScript</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span> useSourceMap<span class="token punctuation" >:</span> <span class="token boolean" >true</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
</div>
      <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>

  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>If you execute <code>npm run build</code> now, you should see smaller results:</p>
<pre><code class="lang-bash">Hash: 9f9739ce8a8c059354ae
Version: webpack 2.2.1
Time: 3410ms
                                 Asset       Size  Chunks                    Chunk Names
                                app.js  606 bytes       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
  674f50d287a8c48dc19ba404d20fe713.eot     166 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>  <span class="token punctuation" >[</span>big<span class="token punctuation" >]</span>
  b06871f281fee6b241d60582ae9369b9.ttf     166 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>  <span class="token punctuation" >[</span>big<span class="token punctuation" >]</span>
af7ae505a9eed503f8b8e6982036873e.woff2    77.2 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>  <span class="token punctuation" >[</span>big<span class="token punctuation" >]</span>
 fee66e712a8a08eef5805a46892932ad.woff      98 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>  <span class="token punctuation" >[</span>big<span class="token punctuation" >]</span>
  9a0d8fb85dedfde24f1ab4cdb568ef2a.png    17.6 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
                                  0.js  160 bytes       0  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
  912ec66d7572ff821749319396470bde.svg     444 kB          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>  <span class="token punctuation" >[</span>big<span class="token punctuation" >]</span>
                             vendor.js    41.8 kB       2  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         vendor
                               app.css     3.5 kB       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
                              0.js.map  769 bytes       0  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
                            app.js.map    5.18 kB       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
                           app.css.map   84 bytes       1  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         app
                         vendor.js.map     343 kB       2  <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>         vendor
                            index.html  274 bytes          <span class="token punctuation" >[</span>emitted<span class="token punctuation" >]</span>
   <span class="token punctuation" >[</span>3<span class="token punctuation" >]</span> ./~/react/lib/ReactElement.js 11.2 kB <span class="token punctuation" >{</span>2<span class="token punctuation" >}</span> <span class="token punctuation" >[</span>built<span class="token punctuation" >]</span>
   <span class="token punctuation" >[</span>7<span class="token punctuation" >]</span> ./~/react/react.js 56 bytes <span class="token punctuation" >{</span>2<span class="token punctuation" >}</span> <span class="token punctuation" >[</span>built<span class="token punctuation" >]</span>
  <span class="token punctuation" >[</span>19<span class="token punctuation" >]</span> ./app/component.js 372 bytes <span class="token punctuation" >{</span>1<span class="token punctuation" >}</span> <span class="token punctuation" >[</span>built<span class="token punctuation" >]</span>
<span class="token punctuation" >..</span>.
</code></pre>
<p>Given it needs to do more work, it took longer to execute the build. But on the plus side the build is significantly smaller now and our vendor build went from 141 kB to roughly 42 kB.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>UglifyJS warnings can help you to understand how it processes the code. Therefore, it may be beneficial to have a peek at the full output every once in a while.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>There&#39;s a standalone version of the plugin known as <a href="https://www.npmjs.com/package/uglifyjs-webpack-plugin">uglifyjs-webpack-plugin</a>. It allows you to control the version of UglifyJS you are using.</blockquote><h2 class="header"><a class="header-anchor" href="#tree-shaking" id="tree-shaking"></a><span class="text">Tree Shaking</span><a class="header-anchor-select" href="#tree-shaking">#</a></h2>
<p>Webpack supports a feature enabled by the ES6 module definition known as <strong>tree shaking</strong>. The idea is that given it is possible to analyze the module definition in a static way without running it, webpack can tell which parts of the code are being used and which are not. It is possible to verify this behavior by expanding the application a little and adding code there that should be eliminated.</p>
<p>Adjust the component as follows:</p>
<p><strong>app/component.js</strong></p>
<pre><code class="lang-javascript"><div class="leanpub-delete">
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token keyword" >function</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >const</span> component <span class="token operator" >=</span> <span class="token keyword" >function</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
</div>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-delete">
<span class="token punctuation" >}</span>
</div>
<div class="leanpub-insert">
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> treeShakingDemo <span class="token operator" >=</span> <span class="token keyword" >function</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token string" >'this should get shaken out'</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token punctuation" >{</span>
  component<span class="token punctuation" >,</span>
  treeShakingDemo<span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</div>
</code></pre>
<p>The application entry point needs a slight change as well given the module definition changed:</p>
<p><strong>app/index.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token string" >'purecss'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token string" >'./main.css'</span><span class="token punctuation" >;</span>
<div class="leanpub-delete">
<span class="token keyword" >import</span> component <span class="token keyword" >from</span> <span class="token string" >'./component'</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >import</span> <span class="token punctuation" >{</span> component <span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'./component'</span><span class="token punctuation" >;</span>
</div>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>If you build the project again (<code>npm run build</code>), the vendor bundle should remain exactly the same while the application bundle changes due to the different kind of import. Webpack should pick up the unused code and shake it out of the project.</p>
<p>The same idea works with dependencies that use the ES6 module definition. Given the related packaging standards are still emerging, it is possible you may have to be careful when consuming such packages. Webpack will try to resolve <em>package.json</em> <code>module</code> field for this purpose. See the <em>Consuming Packages</em> chapter for related techniques.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>If you want to see which parts of the code tree shaking affects, enable warnings at the <code>UglifyJsPlugin</code>. In addition to other messages, you should see lines like <code>Dropping unused variable treeShakingDemo [./app/component.js:17,6]</code>.</blockquote><h2 class="header"><a class="header-anchor" href="#controlling-uglifyjs-through-webpack" id="controlling-uglifyjs-through-webpack"></a><span class="text">Controlling UglifyJS through Webpack</span><a class="header-anchor-select" href="#controlling-uglifyjs-through-webpack">#</a></h2>
<p>An UglifyJS feature known as <strong>mangling</strong> will be enabled by default. The feature will reduce local function and variable names to a minimum, usually to a single character. It can also rewrite properties to a more compact format if configured specifically.</p>
<p>Given these transformations can break your code, you must be a little careful. A good example of this is Angular 1 and its dependency injection system. As it relies on strings, you must be careful not to mangle those or else it will fail to work.</p>
<p>Beyond mangling, it is possible to control all other <a href="http://lisperator.net/uglifyjs/">UglifyJS features</a> through webpack as illustrated below:</p>
<pre><code class="lang-javascript"><span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>optimize<span class="token punctuation" >.</span>UglifyJsPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  <span class="token comment" spellcheck="true">// Don't beautify output (enable for neater output)</span>
  beautify<span class="token punctuation" >:</span> <span class="token boolean" >false</span><span class="token punctuation" >,</span>

  <span class="token comment" spellcheck="true">// Eliminate comments</span>
  comments<span class="token punctuation" >:</span> <span class="token boolean" >false</span><span class="token punctuation" >,</span>

  <span class="token comment" spellcheck="true">// Compression specific options</span>
  compress<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    warnings<span class="token punctuation" >:</span> <span class="token boolean" >false</span><span class="token punctuation" >,</span>

    <span class="token comment" spellcheck="true">// Drop `console` statements</span>
    drop_console<span class="token punctuation" >:</span> <span class="token boolean" >true</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>

  <span class="token comment" spellcheck="true">// Mangling specific options</span>
  mangle<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    <span class="token comment" spellcheck="true">// Don't mangle $</span>
    except<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'$'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>

    <span class="token comment" spellcheck="true">// Don't care about IE8</span>
    screw_ie8 <span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>

    <span class="token comment" spellcheck="true">// Don't mangle function names</span>
    keep_fnames<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>If you enable mangling, it is a good idea to set <code>except: [&#39;webpackJsonp&#39;]</code> to avoid mangling the webpack runtime.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Dropping the <code>console</code> statements can be achieved through Babel too by using the <a href="https://www.npmjs.com/package/babel-plugin-remove-console">babel-plugin-remove-console</a> plugin. Babel is discussed in greater detail in the <em>Processing with Babel</em> chapter.</blockquote><h2 class="header"><a class="header-anchor" href="#other-solutions" id="other-solutions"></a><span class="text">Other Solutions</span><a class="header-anchor-select" href="#other-solutions">#</a></h2>
<p>Yet another way to control UglifyJS would be to use the <a href="https://www.npmjs.com/package/uglify-loader">uglify-loader</a>. That gives yet another way to control minification behavior. <a href="https://www.npmjs.com/package/webpack-parallel-uglify-plugin">webpack-parallel-uglify-plugin</a> allows you to parallelize the minifying step and may yield extra performance as webpack doesn&#39;t run in parallel by default.</p>
<p>I&#39;ve listed a couple of UglifyJS alternatives below:</p>
<ul>
<li><a href="https://www.npmjs.com/package/webpack-closure-compiler">webpack-closure-compiler</a> runs parallel and may give even smaller result than UglifyJS.</li>
<li><a href="https://www.npmjs.com/package/babili">babili</a> is a Babel specific solution. It can be used either as a CLI tool or through <a href="https://www.npmjs.com/package/babili-webpack-plugin">babili-webpack-plugin</a>.</li>
<li><a href="https://www.npmjs.com/package/optimize-js-plugin">optimize-js-plugin</a> complements the other solutions by wrapping eager functions. The benefit of doing this is that it enhances the way your JavaScript code gets parsed initially. This plugin relies on <a href="https://github.com/nolanlawson/optimize-js">optimize-js</a> by Nolan Lawson. <a href="https://www.npmjs.com/package/v8-lazy-parse-webpack-plugin">v8-lazy-parse-webpack-plugin</a> is a similar, highly experimental, plugin doing something similar with V8.</li>
</ul>
<h2 class="header"><a class="header-anchor" href="#minifying-css" id="minifying-css"></a><span class="text">Minifying CSS</span><a class="header-anchor-select" href="#minifying-css">#</a></h2>
<p><em>css-loader</em> allows minifying CSS through <a href="http://cssnano.co/">cssnano</a>. Minification needs to be enabled explicitly using the <code>minimize</code> option. You can also pass <a href="http://cssnano.co/optimisations/">cssnano specific options</a> to the query to customize the behavior further.</p>
<p><a href="https://www.npmjs.com/package/clean-css-loader">clean-css-loader</a> allows you to use a popular CSS minifier known as <a href="https://www.npmjs.com/package/clean-css">clean-css</a>.</p>
<p><a href="https://www.npmjs.com/package/optimize-css-assets-webpack-plugin">optimize-css-assets-webpack-plugin</a> is a plugin based option that applies a chosen minifier on CSS assets. Using <em>extract-text-webpack-plugin</em> can lead to duplicated CSS given it only merges text chunks. <em>optimize-css-assets-webpack-plugin</em> avoids this problem by operating on the generated result and thus can lead to a better result.</p>
<blockquote class="warning"><i class="icon-attention"></i>In webpack 1 <code>minimize</code> was set on by default if <code>UglifyJsPlugin</code> was used. This confusing behavior was fixed in webpack 2 and now you have explicit control over minification.</blockquote><h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Minification is the simplest step you can take to make your build smaller. However, there are a few more tricks we can perform.</p>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this chapter, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/assets/img/chapters/production.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack/optimizing-build">Optimizing the Build</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/assets/img/chapters/firewood.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack/optimizing-build/setting-environment-variables">Setting Environment Variables</a></div></div><blockquote class="tip"><p>This book is <a href="https://leanpub.com/survivejs-webpack">available through Leanpub</a>. By purchasing the book you support the development of further content. A part of profit (~30%) goes to Tobias Koppers, the author of Webpack.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Setting Environment Variables" href="/webpack/optimizing-build/setting-environment-variables"><i class="icon-right-open"></i></a><a class="previous-page" title="Optimizing the Build" href="/webpack/optimizing-build"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a class="" href="/">Home</a></div><div class="nav__link"><a class="" href="/blog">Read the blog</a></div><div class="nav__link"><a class="" href="https://leanpub.com/survivejs-webpack">Buy the ebook</a></div><div class="nav__link"><a class="" href=""></a></div><div class="nav__link"><a class="" href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><a href="https://github.com/survivejs/webpack" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="position:absolute;top:0;fill:#000;right:0;"><path class="octo-banner" d="M0 0l115 115h15l12 27 108 108V0z" fill="#fff"></path><path class="octo-arm" d="M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16" style="-webkit-transform-origin:130px 106px;transform-origin:130px 106px;"></path><path class="octo-body" d="M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z"></path></svg></a><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank">GitHub</a></li><li><a href="/atom.xml" target="_blank">Blog RSS</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/survivejs-webpack-170">SurviveJS - Webpack - v1.7.0</a></li><li><a class="blog-teaser" href="/blog/unexpected-interview">Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen</a></li><li><a class="blog-teaser" href="/blog/ajv-interview">ajv - The Fastest JSON Schema Validator - Interview with Evgeny Poberezkin</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-160">SurviveJS - Webpack - v1.6.0</a></li><li><a class="blog-teaser" href="/blog/isomorphic-webpack-interview">isomorphic-webpack - Universal module consumption using webpack - Interview with Gajus Kuizinas</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-150">SurviveJS - Webpack - v1.5.0</a></li><li><a class="blog-teaser" href="/blog/styletron-interview">Styletron - Universal, high-performance JavaScript styles - Interview with Ryan Tsao</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-142">SurviveJS - Webpack - v1.4.2</a></li><li><a class="blog-teaser" href="/blog/inferno-interview">Inferno - Blazing fast, React-like UI library - Interview with Dominic Gannaway</a></li><li><a class="blog-teaser" href="/blog/svelte-interview">Svelte - The magical disappearing UI framework - Interview with Rich Harris</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
            ((window.gitter = {}).chat = {}).options = {
              showChatByDefault: false,
              activationElement: '.gitter-open-chat-button',
              room: 'survivejs/webpack'
            };
          </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
            docsearch({
              apiKey: '1182e3806d62e921613b8dc9c7a22ef3',
              indexName: 'survivejs_webpack',
              inputSelector: '#search',
              debug: false
            });
          </script></div></main></body></html>