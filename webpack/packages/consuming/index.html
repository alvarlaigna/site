<html lang="en"><head><title>Consuming Packages</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui"/><meta name="description" content="
Even though consuming npm packages is simple using webpack, there are certain special considerations to take into account. Sometimes the packages might not play with you nicely or they might require special tweaking to work properly. At the core of this is the concept of SemVer.

"/><meta name="keywords" content="webpack,react,javascript,programming,web development"/><link rel="icon" type="image/png" href="/assets/img/favicon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"/><link rel="stylesheet" href="/assets/main.css"/></head><body><main role="main"><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/assets/img/chapters/chunks.jpg);"></div><h1 class="post__heading">Consuming Packages</h1><div class="header-extra"><a href="https://pixabay.com/en/white-chocolate-chocolate-sweet-380702/">caja (Public Domain)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/introduction">Introduction</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/compared">Webpack Compared</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/why-webpack">Why Webpack?</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/developing">Developing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/getting-started">Getting Started</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/automatic-browser-refresh">Automatic Browser Refresh</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/configuring-hmr">Configuring Hot Module Replacement</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/linting">Linting JavaScript</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/composing-configuration">Composing Configuration</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/styling">Styling</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/loading">Loading Styles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/separating-css">Separating CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/autoprefixing">Autoprefixing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/eliminating-unused-css">Eliminating Unused CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/linting">Linting CSS</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/loading">Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/loader-definitions">Loader Definitions</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/images">Loading Images</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/fonts">Loading Fonts</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/javascript">Loading JavaScript</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/building">Building</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/source-maps">Source Maps</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/splitting-bundles">Splitting Bundles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/code-splitting">Code Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/tidying-up">Tidying Up</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/optimizing">Optimizing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/minifying">Minifying the Build</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/tree-shaking">Tree Shaking</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/setting-environment-variables">Setting Environment Variables</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/adding-hashes-to-filenames">Adding Hashes to Filenames</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/separating-manifest">Separating a Manifest</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/analyzing-build-statistics">Analyzing Build Statistics</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/performance">Performance</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/output">Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/targets">Build Targets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/library-output">Library Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/multiple-pages">Multiple Pages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/server-side-rendering">Server Side Rendering</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/packages">Packages</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Consuming Packages</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring">Authoring Packages</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/extending">Extending</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/loaders">Extending Webpack with Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/plugins">Extending Webpack with Plugins</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/appendices">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/searching-with-react">Searching with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr-with-react">Hot Module Replacement with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/customizing-eslint">Customizing ESLint</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/deploying">Deploying Applications</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/dynamic-loading">Dynamic Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/using-web-workers">Using Web Workers</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/i18n">Internationalization</a></li></ul><div><div class="buy-container"><a href="/webpack/introduction"><img class="sidebar-cover" src="/assets/img/webpack_title_page_small.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img class="sidebar-cover" src="/assets/img/react_title_page_small.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div></div></div><div class="chapter"><div class="post__content"><blockquote class="latestpost tip"><div>From the blog:</div><a class="latestpost-link" href="/blog/survivejs-webpack-18">SurviveJS - Webpack - v1.8</a></blockquote><div class="chapter-content"><p>Even though consuming npm packages is simple using webpack, there are certain special considerations to take into account. Sometimes the packages might not play with you nicely or they might require special tweaking to work properly. At the core of this is the concept of SemVer.</p>
<h2 class="header"><a class="header-anchor" href="#understanding-semver" id="understanding-semver"></a><span class="text">Understanding SemVer</span><a class="header-anchor-select" href="#understanding-semver">#</a></h2>
<p>Most popular packages out there comply with SemVer. It&#39;s problematic as sometimes packages may inadvertently break it, but there are ways around this. Roughly, SemVer states that you should not break backwards compatibility, given <a href="http://semver.org/">certain rules</a> are met:</p>
<ol>
<li>The MAJOR version gets incremented when incompatible API changes are made to stable APIs.</li>
<li>The MINOR version gets incremented when backwards-compatible functionality is added.</li>
<li>The PATCH version gets incremented when backwards-compatible bug is fixed.</li>
</ol>
<p>The rules are a little different for <code>0.x</code> versions. There the rule is <code>0.&lt;MAJOR&gt;.&lt;MINOR&gt;</code>. For packages considered stable and suitable for public usage (<code>1.0.0</code> and above), the rules is <code>&lt;MAJOR&gt;.&lt;MINOR&gt;.&lt;PATCH&gt;</code>. For example, if the current version of a package is <code>0.1.4</code> and a breaking change is performed, it should bump to <code>0.2.0</code>.</p>
<p>Given SemVer can be a little tricky to manage, some packages use a backwards compatible alternative <a href="https://github.com/staltz/comver">ComVer</a>. ComVer can be described as a binary decision <code>&lt;not compatible&gt;.&lt;compatible&gt;</code>.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>You can understand SemVer much better by studying <a href="http://semver.npmjs.com/">the online tool</a> and how it behaves.</blockquote><h2 class="header"><a class="header-anchor" href="#understanding-npm-lookup" id="understanding-npm-lookup"></a><span class="text">Understanding npm Lookup</span><a class="header-anchor-select" href="#understanding-npm-lookup">#</a></h2>
<p>npm&#39;s lookup algorithm is another aspect that&#39;s good to understand. Sometimes this can explain certain errors, and it also leads to good practices, such as preferring local dependencies over global ones. The basic algorithm goes like this:</p>
<ol>
<li>Look into immediate packages. If there is <em>node_modules</em>, crawl through that. This will also check the parent directories until it reaches project root. You can check that using <code>npm root</code>.</li>
<li>If nothing was found, check globally installed packages. If you are using Unix, look into <em>/usr/local/lib/node_modules</em> to find them. You can figure out the exact directory using <code>npm root -g</code>.</li>
<li>If the global lookup fails, it will fail hard. You should get an error now.</li>
</ol>
<p>On a package level, npm resolves to a file like this:</p>
<ol>
<li>Look up <em>package.json</em> of the package.</li>
<li>Get the contents of the <code>main</code> field. If it doesn&#39;t exist, default to <em><package>/index.js</em>.</li>
<li>Resolve to the <code>main</code> file.</li>
</ol>
<p>The general lookup algorithm respects an environment variable <code>NODE_PATH</code>. If you want to tweak the resolution further, you can attach specific directories to it. Example: <code>NODE_PATH=$NODE_PATH:./demo</code>. A call like this can be included in the beginning of a <em>package.json</em> script to patch the runtime environment temporarily, although it&#39;s better to avoid this if possible.</p>
<p>You can tweak webpack&#39;s module resolution through the <code>resolve.modules</code> field. Example:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  resolve<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    modules<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
      path<span class="token punctuation" >.</span><span class="token function" >join</span><span class="token punctuation" >(</span>__dirname<span class="token punctuation" >,</span> <span class="token string" >'demo'</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
      <span class="token string" >'node_modules'</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>Sometimes it may be beneficial to use these techniques together. Compared to npm environment, webpack provides more flexibility, although you can mimic a lot of webpack&#39;s functionality using terminal based tricks.</p>
<blockquote class="warning"><i class="icon-attention"></i>Installing packages globally can lead to surprising behavior. If you have a package installed both globally and it a project happens to contain it, executing associated terminal command (say <code>webpack</code>) will point to the version of the project. This won&#39;t work unless the global package exists.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://www.npmjs.com/package/app-module-path">app-module-path</a> allows you adjust Node module lookup within JavaScript. This can be an interesting alternative to patching <code>NODE_PATH</code>.</blockquote><h2 class="header"><a class="header-anchor" href="#version-ranges" id="version-ranges"></a><span class="text">Version Ranges</span><a class="header-anchor-select" href="#version-ranges">#</a></h2>
<p>npm supports multiple version ranges. I&#39;ve listed the common ones below:</p>
<ul>
<li><code>~</code> - Tilde matches only patch versions. For example, <code>~1.2</code> would be equal to <code>1.2.x</code>.</li>
<li><code>^</code> - Caret is the default you get using <code>--save</code> or <code>--save-dev</code>. It matches minor versions. This means <code>^0.2.0</code> would be equal to <code>0.2.x</code>.</li>
<li><code>*</code> - Asterisk matches major releases. This is the most dangerous of the ranges. Using this recklessly can easily break your project in the future and I would advise against using it.</li>
<li><code>&gt;= 1.3.0 &lt; 2.0.0</code> - Range between versions. This can be particularly useful if you are using <code>peerDependencies</code>.</li>
</ul>
<p>You can set the default range using <code>npm config set save-prefix=&#39;^&#39;</code> in case you prefer something else than caret. Alternately, you can modify <em>~/.npmrc</em> directly. Especially defaulting to tilde can be a good idea that can help you to avoid some trouble with dependencies, although it won&#39;t remove potential problems entirely. That&#39;s where shrinkwrapping comes in.</p>
<h2 class="header"><a class="header-anchor" href="#shrinkwrapping-versions" id="shrinkwrapping-versions"></a><span class="text">Shrinkwrapping Versions</span><a class="header-anchor-select" href="#shrinkwrapping-versions">#</a></h2>
<p>Using version ranges can feel a little dangerous as it doesn&#39;t take much to break an application. A single change in the wrong place is enough. <a href="https://docs.npmjs.com/cli/shrinkwrap">npm shrinkwrap</a> allows you to fix your dependency versions and have stricter control over the versions you are using in a production environment. Most importantly it fixes the dependencies of your dependencies avoiding accidental breakage due to version changes and SemVer.</p>
<p><a href="https://www.npmjs.com/package/lockdown">lockdown</a> goes further and gives guarantees about dependency content, not version alone. <a href="https://www.npmjs.com/package/shrinkpack">shrinkpack</a> is another interesting complementary option.</p>
<p><a href="https://yarnpkg.com/">Yarn</a>, an npm alternative, goes a step further as it introduces the idea of a <em>lockfile</em>. Yarn is worth a look, as it fixes certain shortcomings of npm.</p>
<h2 class="header"><a class="header-anchor" href="#keeping-dependencies-up-to-date" id="keeping-dependencies-up-to-date"></a><span class="text">Keeping Dependencies Up to Date</span><a class="header-anchor-select" href="#keeping-dependencies-up-to-date">#</a></h2>
<p>An important part of maintaining a project is keeping their dependencies up to date. How to do this depends a lot on the maturity of your project. Ideally, you have a nice set of tests covering the functionality. If not, things can get a little hairier. You can consider the following approaches:</p>
<ul>
<li>You can update all dependencies at once and hope for the best. Tools, such as <a href="https://www.npmjs.com/package/npm-check-updates">npm-check-updates</a>, <a href="https://www.npmjs.com/package/npm-check">npm-check</a>, <a href="https://www.npmjs.com/package/npm-upgrade">npm-upgrade</a>, or <a href="https://www.npmjs.com/package/updtr">updtr</a>, can do this for you.</li>
<li>Install the newest version of some specific dependency, e.g., <code>npm install lodash@* --save</code>. This is a more controlled way to approach the problem.</li>
<li>Patch version information by hand by modifying <em>package.json</em> directly.</li>
</ul>
<p>It is important to remember that your dependencies may introduce backwards incompatible changes. It can be useful to remember how SemVer works and study release notes of dependencies. They might not always exist, so you may have to go through the project commit history.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i><code>npm ls</code>, and more specifically <code>npm ls &lt;package name&gt;</code>, allow you to figure out which versions you have installed. <code>npm ls -g</code> performs a similar lookup against the globally installed packages.</blockquote><h2 class="header"><a class="header-anchor" href="#tracking-dependencies" id="tracking-dependencies"></a><span class="text">Tracking Dependencies</span><a class="header-anchor-select" href="#tracking-dependencies">#</a></h2>
<p>There are certain services that can help you to keep track of your dependencies:</p>
<ul>
<li><a href="https://david-dm.org/">David</a></li>
<li><a href="https://www.versioneye.com/">versioneye</a></li>
<li><a href="https://gemnasium.com">Gemnasium</a></li>
</ul>
<p>These services provide badges you can integrate into your project <em>README.md</em>, and they may email you about important changes. They can also point out possible security issues that have been fixed.</p>
<p>For testing your project, you can consider solutions, such as <a href="https://travis-ci.org/">Travis CI</a> or <a href="https://saucelabs.com/">SauceLabs</a>. They can test your project against different environments and browsers. The advantage of doing this is that it allows you to detect regressions. If you accept pull requests to your project, these services can help to keep their quality higher as it forces the authors to maintain their code on higher level.</p>
<p><a href="https://codecov.io/">Codecov</a> and <a href="https://coveralls.io/">Coveralls</a> provide code coverage information and a badge to include in your README. This is useful for figuring out which portions of the source to test better. It is a part of improving the quality of your pull requests as they should maintain the current coverage at minimum and ideally improve it.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i><a href="http://shields.io/">shields.io</a> lists a large number of available badges. <a href="https://nodei.co/">NodeICO</a> provides badges that aggregate package related information.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>There&#39;s a <a href="https://chrome.google.com/webstore/detail/codecov-extension/keefkhehidemnokodkdkejapdgfjmijf">Codecov extension</a> for Chrome that allows you to see code coverage through GitHub user interface.</blockquote><h2 class="header"><a class="header-anchor" href="#tweaking-module-resolution" id="tweaking-module-resolution"></a><span class="text">Tweaking Module Resolution</span><a class="header-anchor-select" href="#tweaking-module-resolution">#</a></h2>
<p>Sometimes packages might not follow the standard rules and their <em>package.json</em> might have a faulty <code>main</code> field or it might be missing altogether. This is where setting up a <code>resolve.alias</code> can come in handy. Consider the example below:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  resolve<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    alias<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      demo<span class="token punctuation" >:</span> path<span class="token punctuation" >.</span><span class="token function" >resolve</span><span class="token punctuation" >(</span>__dirname<span class="token punctuation" >,</span> <span class="token string" >'node_modules/demo/dist/demo.js'</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>The idea is that if webpack resolver matches <code>demo</code> in the beginning, it will resolve from the target. You can constrain the process to an exact name by using a pattern like <code>demo$</code>.</p>
<p>The technique is useful with React too. Light alternatives, such as <a href="https://www.npmjs.com/package/preact">Preact</a>, <a href="https://www.npmjs.com/package/react-lite">react-lite</a>, or <a href="https://www.npmjs.com/package/inferno">Inferno</a>, offer smaller size while trading off some functionality like <code>propTypes</code> and synthetic event handling. Replacing React with a lighter alternative can save a significant amount of space, but you should test well if you do this. The setup looks like this for <em>react-lite</em>. The idea is the same for others:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  resolve<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    alias<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token string" >'react'</span><span class="token punctuation" >:</span> <span class="token string" >'react-lite'</span><span class="token punctuation" >,</span>
      <span class="token string" >'react-dom'</span><span class="token punctuation" >:</span> <span class="token string" >'react-lite'</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>The same technique works with loaders too. You can use <code>resolveLoader.alias</code> in the same way to alias a loader elsewhere. This can be particularly useful if you have to adapt a RequireJS project to work with webpack.</blockquote><h2 class="header"><a class="header-anchor" href="#dealing-with-globals" id="dealing-with-globals"></a><span class="text">Dealing with Globals</span><a class="header-anchor-select" href="#dealing-with-globals">#</a></h2>
<p>Sometimes modules might depend on globals, like the <code>$</code> provided by jQuery. <a href="https://www.npmjs.com/package/imports-loader">imports-loader</a> allows you to inject them as below:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  module<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    rules<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token comment" spellcheck="true">// Resolve against package path.</span>
      <span class="token comment" spellcheck="true">// require.resolve returns a path to it.</span>
      test<span class="token punctuation" >:</span> require<span class="token punctuation" >.</span><span class="token function" >resolve</span><span class="token punctuation" >(</span><span class="token string" >'jquery-plugin'</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
      loader<span class="token punctuation" >:</span> <span class="token string" >'imports-loader?$=jquery'</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>Webpack&#39;s <code>ProvidePlugin</code> can be used for a similar purpose. It allows webpack to resolve globals as it encounters them:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>ProvidePlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      $<span class="token punctuation" >:</span> <span class="token string" >'jquery'</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<h2 class="header"><a class="header-anchor" href="#removing-unused-modules" id="removing-unused-modules"></a><span class="text">Removing Unused Modules</span><a class="header-anchor-select" href="#removing-unused-modules">#</a></h2>
<p>Even though packages might work well out of the box, they might bring too much code to your project by default. <a href="https://www.npmjs.com/package/moment">Moment.js</a> is a popular example. It brings locale data to your project by default. The simplest way to disable that behavior is to use <code>IgnorePlugin</code> to ignore locales like this:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>IgnorePlugin</span><span class="token punctuation" >(</span><span class="token regex" >/^\.\/locale$/</span><span class="token punctuation" >,</span> <span class="token regex" >/moment$/</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>You can use the same mechanism to work around problematic dependencies. Example: <code>new webpack.IgnorePlugin(/^(buffertools)$/)</code>.</blockquote><p>To bring specific locales to your project, you should use <code>ContextReplacementPlugin</code>:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>ContextReplacementPlugin</span><span class="token punctuation" >(</span>
      <span class="token regex" >/moment[\/\\]locale$/</span><span class="token punctuation" >,</span>
      <span class="token regex" >/de|fi/</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>There&#39;s a <a href="https://stackoverflow.com/questions/25384360/how-to-prevent-moment-js-from-loading-locales-with-webpack/25426019">Stack Overflow question</a> that covers these ideas in detail.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://www.npmjs.com/package/null-loader">null-loader</a> discussed in the <a href="/webpack/loading/fonts">Loading Fonts</a> chapter can be used to achieve a similar effect.</blockquote><h2 class="header"><a class="header-anchor" href="#managing-pre-built-dependencies" id="managing-pre-built-dependencies"></a><span class="text">Managing Pre-built Dependencies</span><a class="header-anchor-select" href="#managing-pre-built-dependencies">#</a></h2>
<p>It is possible webpack will give the following warning with certain dependencies:</p>
<pre><code class="lang-bash">WARNING <span class="token keyword" >in</span> <span class="token punctuation" >..</span>/~/jasmine-promises/dist/jasmine-promises.js
Critical dependencies:
1:113-120 This seems to be a pre-built javascript file. Though this is possible, it's not recommended. Try to require the original <span class="token function" >source</span> to get better results.
 @ <span class="token punctuation" >..</span>/~/jasmine-promises/dist/jasmine-promises.js 1:113-120
</code></pre>
<p>This can happen if a package points at a pre-built (i.e., minified and already processed) file. Webpack detects this case and warns against it.</p>
<p>One way to eliminate the warning would be to alias the package to a source version as discussed above. Given sometimes the source might not be available, another option is to tell webpack to skip parsing the files through <code>module.noParse</code>. It accepts either a RegExp or an array of RegExps and can be configured as below:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  module<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    noParse<span class="token punctuation" >:</span> <span class="token regex" >/node_modules\/demo-package\/dist\/demo-package.js/</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>There&#39;s a <a href="https://github.com/webpack/webpack/issues/1617">webpack issue</a> that discusses the problem in detail.</blockquote><blockquote class="warning"><i class="icon-attention"></i>Disabling warnings like this one should be the last measure as doing it can hide underlying issues. Do this only if you know what you are doing and consider alternatives first.</blockquote><h2 class="header"><a class="header-anchor" href="#exposing-globals-to-the-browser" id="exposing-globals-to-the-browser"></a><span class="text">Exposing Globals to the Browser</span><a class="header-anchor-select" href="#exposing-globals-to-the-browser">#</a></h2>
<p>Sometimes you may have to expose packages to third party scripts. This is possible by using <a href="https://www.npmjs.com/package/expose-loader">expose-loader</a>. Configure as follows:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  test<span class="token punctuation" >:</span> require<span class="token punctuation" >.</span><span class="token function" >resolve</span><span class="token punctuation" >(</span><span class="token string" >'react'</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  use<span class="token punctuation" >:</span> <span class="token string" >'expose-loader?React'</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>With small extra tweak, the technique can be used to expose React performance utilities to the browser through <code>React.Perf</code> global. You have to insert the following code to your application entry point for this to work:</p>
<pre><code class="lang-javascript"><span class="token keyword" >if</span> <span class="token punctuation" >(</span>process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>NODE_ENV <span class="token operator" >!==</span> <span class="token string" >'production'</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  React<span class="token punctuation" >.</span>Perf <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'react-addons-perf'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>It can be a good idea to install <a href="https://github.com/facebook/react-devtools">React Developer Tools</a> to Chrome for even more information. This allows you to inspect <em>props</em> and <em>state</em> of your application.</blockquote><h2 class="header"><a class="header-anchor" href="#getting-insights-on-packages" id="getting-insights-on-packages"></a><span class="text">Getting Insights on Packages</span><a class="header-anchor-select" href="#getting-insights-on-packages">#</a></h2>
<p>Even though it&#39;s easy to consume packages through npm, there are times when it&#39;s useful to have more information available. npm provides <code>npm info &lt;package&gt;</code> command for basic queries. You can use it to check the metadata associated to packages while figuring out version related information.</p>
<p><a href="https://www.npmjs.com/package/package-config-checker">package-config-checker</a> goes a step further. It allows you to understand better which packages of your project have updated recently and it provides means to get insight into your dependencies. It can reveal which packages could use download size related improvements for example.</p>
<p><a href="https://www.npmjs.com/package/slow-deps">slow-deps</a> can reveal which dependencies of a project are the slowest to install.</p>
<p><a href="https://www.npmjs.com/package/weigh">weigh</a> can be used figure out the approximate size of a package when it&#39;s served to a browser in different ways (uncompressed, minified, gzipped).</p>
<p><a href="https://npms.io/">npms.io</a> provides a better search for npm. The basic search has been integrated to <a href="https://www.npmjs.com/">npmjs.org</a>, but npms.io can still be interesting especially because they expose their data through <a href="https://api-docs.npms.io/">a public API</a> you can query programmatically.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Webpack can consume most npm packages without a hitch. Sometimes, though, some patching might be required. Fortunately, its resolution mechanism is patchable enough and you can modify the way it brings source to your project if needed.</p>
<p>In the next chapter, we&#39;ll discuss how to author your own npm packages. It&#39;s the other side of the same coin and worth understanding if you won&#39;t end up authoring packages of your own.</p>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this chapter, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/assets/img/chapters/skydiving.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack/packages">Packages</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/assets/img/chapters/library.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack/packages/authoring">Authoring Packages</a></div></div><blockquote class="tip"><p>This book is <a href="https://leanpub.com/survivejs-webpack">available through Leanpub</a>. By purchasing the book you support the development of further content. A part of profit (~30%) goes to Tobias Koppers, the author of Webpack.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Authoring Packages" href="/webpack/packages/authoring"><i class="icon-right-open"></i></a><a class="previous-page" title="Packages" href="/webpack/packages"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a class="" href="/">Home</a></div><div class="nav__link"><a class="" href="/blog">Read the blog</a></div><div class="nav__link"><a class="" href="https://leanpub.com/survivejs-webpack">Buy the ebook</a></div><div class="nav__link"><a class="" href=""></a></div><div class="nav__link"><a class="" href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><a href="https://github.com/survivejs/webpack" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="position:absolute;top:0;fill:#000;right:0;"><path class="octo-banner" d="M0 0l115 115h15l12 27 108 108V0z" fill="#fff"></path><path class="octo-arm" d="M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16" style="-webkit-transform-origin:130px 106px;transform-origin:130px 106px;"></path><path class="octo-body" d="M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z"></path></svg></a><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank">GitHub</a></li><li><a href="/atom.xml" target="_blank">Blog RSS</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/survivejs-webpack-18">SurviveJS - Webpack - v1.8</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-170">SurviveJS - Webpack - v1.7.0</a></li><li><a class="blog-teaser" href="/blog/unexpected-interview">Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen</a></li><li><a class="blog-teaser" href="/blog/ajv-interview">ajv - The Fastest JSON Schema Validator - Interview with Evgeny Poberezkin</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-160">SurviveJS - Webpack - v1.6.0</a></li><li><a class="blog-teaser" href="/blog/isomorphic-webpack-interview">isomorphic-webpack - Universal module consumption using webpack - Interview with Gajus Kuizinas</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-150">SurviveJS - Webpack - v1.5.0</a></li><li><a class="blog-teaser" href="/blog/styletron-interview">Styletron - Universal, high-performance JavaScript styles - Interview with Ryan Tsao</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-142">SurviveJS - Webpack - v1.4.2</a></li><li><a class="blog-teaser" href="/blog/inferno-interview">Inferno - Blazing fast, React-like UI library - Interview with Dominic Gannaway</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
            ((window.gitter = {}).chat = {}).options = {
              showChatByDefault: false,
              activationElement: '.gitter-open-chat-button',
              room: 'survivejs/webpack'
            };
          </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
            docsearch({
              apiKey: '1182e3806d62e921613b8dc9c7a22ef3',
              indexName: 'survivejs_webpack',
              inputSelector: '#search',
              debug: false
            });
          </script></div></main></body></html>